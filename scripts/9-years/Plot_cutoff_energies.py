""" Plots the cutoff energies of all models as a function of latitude, left and right separately. """

import numpy as np
import pyfits
import healpy
from matplotlib import pyplot
import healpylib as hlib
from iminuit import Minuit

import dio
from yaml import load

#data_class = source 


lats = np.array([-55.0, -45.0, -35.0, -25.0, -15.0, -8.0, -4.0, 0.0, 4.0, 8.0, 15.0, 25.0, 35.0, 45.0, 55.0])

boxes_source_range0 = np.array( [[2372.9756387244233, 111.53017551913233], [134.21416519809188, 119.35504925685326], [172.4981559903568, 1048576.3333130942], [1048576.3333130942, 153.50851016650907], [1048576.3333130942, 85.19439451052475], [92.71548524368937, 1048576.3333130942], [496.5318603370785, 76.78246293065789], [1048576.3333130942, 4.120996888766634], [299.2812757987906, 64.10468062650999], [539.5128285964195, 1048576.3333130942], [3468734043.961098, 1048576.3333130942], [1275328108.6307151, 136509091.5171743], [122761638.74209179, 4340946531.315374], [1048576.3333130942, 54447687398.12663], [4231204219.9026575, 16768155645.590414]] ).T

lowE_source_range0 = np.array( [[634.5878677443728, 59.87185781728204], [115.4299491804866, 125.83221538041363], [134.10065613296692, 77.50883803108144], [51.79429894758947, 133.04912638392648], [84.0311577157389, 70.40631624288365], [119.70584364017226, 1048576.3333130942], [1043.0440439839674, 79.31989783473685], [91652540610.2334, 9.620045528988404], [263.5976254750248, 60.87605616676722], [554.8778412429176, 163.6028755704504], [27.58607893709827, 87.13447999844874], [3.9465610250928713, 2.0471281153653966], [2.1920357542398743, 2.058514421591848], [3.403180148606099, 2.692708090789541], [5.08190615867285, 1.1784739102833748]] ).T

GALPROP_source = np.array( [[400.1062899494975, 51.41623819458256], [163.18472503191532, 159.16726849075516], [705.0942287194923, 121.02940811715095], [94.11550839356921, 186.4359315456664], [194.4782133261497, 137.23644847821038], [72932787487781.31, 45.90895352086667], [75284278201.65068, 2.786460968759119], [227251306.00674313, 12.92018467828575], [34667874921.06273, 2312.4478420849005], [1048576.3333130942, 196.53905342263792], [92.45645878005362, 45.38146287111364], [150.04210579431592, 1048576.3333130942], [254.41002252581504, 101.40580761976591], [152.1836074529366, 491.39674513433505], [2758.333615841854, 46398169.86805536]] ).T

data_source = np.array( [[958.0440057193845, 231.25663828622893], [337.7220160591134, 372.876727978889], [414.4461630143881, 290.35267933308023], [267.374621626537, 479.8269762003619], [520.3208901383617, 382.3303810517163], [2072.78612527852, 1589.0556679896024], [452293517524.4667, 2560682090900.069], [804178318355.5192, 1238613758902.7766], [4921200389.415305, 3422188166694.906], [4982.945275842117, 821.2033869252771], [4848.023276514872, 434.2239327541716], [866.529641543954, 5703.717750150023], [1325.0771956805672, 759.4856546867054], [445.22775379650653, 1078.62809942253], [742.9577729467915, 1441.141470900383]] ).T



########################################################################################################################## Right


pyplot.figure()

pyplot.plot(lats, data_source[0], label = "data")
pyplot.plot(lats, lowE_source_range0[0],  label = "lowE")
pyplot.plot(lats, boxes_source_range0[0], label = "boxes")
pyplot.plot(lats, GALPROP_source[0],  label = "GALPROP")

lg = pyplot.legend(loc='upper left', ncol=1, fontsize = 'medium')
lg.get_frame().set_linewidth(0)
pyplot.grid(True)
pyplot.xlabel(r'$b\ \mathrm{[deg]}$')
pyplot.ylabel(r'$ E_\mathrm{cut}\ \mathrm{[GeV]}$')

#pyplot.title(r'$\ell \in (%i^\circ$' % (Lc[l] - 5) + '$,\ %i^\circ)$, ' % (Lc[l] + 5) + r'$E\in (%.1f\ \mathrm{GeV}$' %emin + r'$,\ %.1f$' %emax + r'$\ \mathrm{GeV})$')

plot_dir = '../../plots/Plots_9-year/Low_energy_range0/'

name = 'Cutoff_energies_l_in_(-10,0).pdf'
fn = plot_dir + name 
pyplot.yscale('log')
#pyplot.ylim(5.e-8, 1.e-4)
pyplot.savefig(fn, format = 'pdf')


########################################################################################################################## Left

pyplot.figure()

pyplot.plot(lats, data_source[1], label = "data")
pyplot.plot(lats, lowE_source_range0[1],  label = "lowE")
pyplot.plot(lats, boxes_source_range0[1], label = "boxes")
pyplot.plot(lats, GALPROP_source[1],  label = "GALPROP")

lg = pyplot.legend(loc='upper left', ncol=1, fontsize = 'medium')
lg.get_frame().set_linewidth(0)
pyplot.grid(True)
pyplot.xlabel(r'$b\ \mathrm{[deg]}$')
pyplot.ylabel(r'$ E_\mathrm{cut}\ \mathrm{[GeV]}$')

pyplot.title(r'$\ell \in (^\circ$' % (Lc[l] - 5) + '$,\ %i^\circ)$, ' % (Lc[l] + 5) + r'$E\in (%.1f\ \mathrm{GeV}$' %emin + r'$,\ %.1f$' %emax + r'$\ \mathrm{GeV})$')

plot_dir = '../../plots/Plots_9-year/Low_energy_range0/'

name = 'Cutoff_energies_l_in_(0,10).pdf'
fn = plot_dir + name 
pyplot.yscale('log')
pyplot.ylim(1.e0, 1.e14)
pyplot.savefig(fn, format = 'pdf')
